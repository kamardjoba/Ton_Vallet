# Руководство по отладке Telegram Mini App

## Как посмотреть логи на телефоне

### iOS (iPhone/iPad)

1. **Подключите iPhone к Mac через USB**
2. **Откройте Safari на Mac**
3. **Включите меню "Develop"**:
   - Safari > Настройки > Дополнительно
   - Отметьте "Показать меню Develop в строке меню"
4. **Откройте консоль**:
   - Develop > [Ваш iPhone] > [Telegram WebView]
   - Или Develop > [Ваш iPhone] > [tonvallet.netlify.app]
5. **В консоли будут видны все логи** (console.log, console.error и т.д.)

### Android

1. **Включите USB отладку на Android**:
   - Настройки > О телефоне > Нажмите 7 раз на "Номер сборки"
   - Настройки > Для разработчиков > USB отладка (включить)
2. **Подключите Android к компьютеру через USB**
3. **Откройте Chrome на компьютере**
4. **Перейдите на** `chrome://inspect`
5. **Найдите Telegram WebView** и нажмите "inspect"
6. **Откройте вкладку Console** для просмотра логов

### Альтернативный способ (без компьютера)

В коде добавлены функции `showDebugInfo()` и `logError()`, которые показывают алерты прямо в Telegram Mini App. Это поможет увидеть ошибки без подключения к компьютеру.

## Что делать, если биометрия не работает

### Вариант 1: Использовать только пароль (рекомендуется)

Биометрия через WebAuthn может не работать в Telegram Mini App из-за ограничений WebView. В этом случае лучше использовать только пароль, но с хорошим UX:

- Быстрый ввод пароля
- Визуальная обратная связь
- Автоматическое скрытие клавиатуры после ввода

### Вариант 2: Упростить биометрию

Можно убрать попытку биометрии и оставить только пароль, но добавить:
- Кнопку "Запомнить на 5 минут" (опционально)
- Быстрый доступ для повторных транзакций

### Вариант 3: Использовать PIN-код

Вместо пароля можно использовать короткий PIN-код (4-6 цифр) для быстрого подтверждения транзакций.

## Текущая реализация

Сейчас в приложении:
1. При нажатии "Send" открывается модальное окно
2. Сразу показывается поле для пароля
3. Если биометрия доступна, показывается кнопка "Use Face ID"
4. При нажатии на кнопку биометрии пытается запуститься Face ID
5. Если биометрия не работает, можно использовать пароль

## Отладка в коде

В коде добавлены функции для отладки:

```typescript
import { showDebugInfo, logError, getEnvironmentInfo } from '../utils/debug';

// Показать информацию
showDebugInfo('Что-то произошло', { data: 'значение' });

// Записать ошибку
logError('Контекст ошибки', error);

// Получить информацию об окружении
const info = getEnvironmentInfo();
```

Эти функции:
- Логируют в console
- Показывают алерты в Telegram (если доступно)
- Помогают понять, что происходит

## Рекомендации

Если биометрия не работает стабильно:
1. **Сделайте пароль основным методом** - это надежнее
2. **Добавьте визуальную индикацию** - покажите пользователю, что происходит
3. **Упростите процесс** - меньше шагов = меньше ошибок
4. **Добавьте кэширование** - запомнить пароль на короткое время (опционально)
